<header class="navbar fixed-top navbar-expand-lg">
  <span class="justify">
      <a class="navbar-brand pull-left"
         href="#"
         (click)="navbarCollapsed = true">
        <img src="assets/images/TERN_logo.png" height="48" class="align-top brand-image-nudge">
      </a>
      
        <span class="navbar-brand">
          Landscape Data Visualiser
          <span class="badge badge-warning">
            <a href="mailto:http://mailto:albert.vandijk@anu.edu.au?subject=[Feedback from Landscape Visualiser]">
              BETA
              <i class="fa fa-flask"></i>
            </a>
          </span>
        </span>

  <a class="navbar-brand pull-right"
     href="https://www.anu.edu.au">
    <img src="assets/images/logo_ANU.png" height="40" class="align-top">
  </a>
  </span>

  <button class="navbar-toggler navbar-toggler-right" type="button" (click)="isNavbarCollapsed = !isNavbarCollapsed" [attr.aria-expanded]="!navbarCollapsed"
    aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
<span class="fa fa-bars"></span>
</button>

  <!--
  <div class="navbar-collapse" [ngbCollapse]="isNavbarCollapsed" id="navbarItems">
    <theme-navbar [catalog]="catalog" (layerSelected)="layerSelected($event)"></theme-navbar>
  </div>
-->

</header>
<div class="container-fluid">
  <div class="row main-row no-gutters">
    <div class="col-3 sidebar">
      <ngb-accordion [activeIds]="openPanels"
                     (panelChange)="panelToggle($event)">

        <ngb-panel class="catalog" id="catalog">
          <ng-template ngbPanelTitle>
            <span>
              <i class="fa" 
                 [ngClass]="panels.catalog?'fa-chevron-down':'fa-chevron-up'"></i>
            </span>&nbsp;
            <span>Catalogue</span>
          </ng-template>
          <ng-template ngbPanelContent>
            <catalog [catalog]="catalog" 
                     (layerSelected)="layerSelected($event)"
                     [showPlaceholders]="false"></catalog>
          </ng-template>
        </ngb-panel>

        <ngb-panel id="layers">
          <ng-template ngbPanelTitle>
            <span>
              <i class="fa" 
                [ngClass]="panels.layers?'fa-chevron-down':'fa-chevron-up'"></i>
            </span>&nbsp;
            <span>Layers shown</span>
          </ng-template>
          <ng-template ngbPanelContent>
            <div>
              <layer-control #layerControl 
                             [layers]="layers"
                             (layersChange)="layersChanged($event)"
                             [map]="map"
                             [showLegends]="false"
                             [allowReorder]="false"></layer-control>
            </div>
          </ng-template>
        </ngb-panel>

      </ngb-accordion>
    </div>
    <div class="col-9 main-map">
      <layered-map #map
                   [layers]="layers"
                   (layersChange)="layersChanged($event)"
                   (featureSelected)="featureSelected($event)"
                   (pointSelected)="pointSelected($event)"
                   [mapTypePosition]="mapTypePosition">
        <button-bar class="map-control left-top">
          <zoom-in [map]="map" [maxZoom]="10"></zoom-in>
          <zoom-out [map]="map" [minZoom]="3"></zoom-out>
          <zoom-full [map]="map" [bounds]="fullExtent"></zoom-full>
          <zoom-layer [map]="map" [layer]="topLayer" [fullBounds]="fullExtent"></zoom-layer>
<!--
          <location-search></location-search>
          <share-view></share-view>
-->
        </button-bar>
        <div class="map-control left-bottom">
          <collapsible-map-control *ngIf="layers.length"
                                   [heading]="'Legend'">
            <div *ngFor="let l of layers">
              <map-legend *ngIf="l.flattenedSettings?.palette || l.legendURL"
                          [title]="l.title"
                          [imageURL]="l.legendURL"
                          [helpText]="l.description()"
                          [mapUnits]="l.flattenedSettings?.units"
                          [cbPalette]="l.flattenedSettings?.palette?.name||l.flattenedSettings?.palette"
                          [cbCount]="l.flattenedSettings?.palette?.count||l.flattenedSettings?.numcolorbands"
                          [cbReverse]="l.flattenedSettings?.palette?.reverse"
                          [cbRange]="l.flattenedSettings?.colorscalerange"
                          [attribution]="l.layer.dataCreator"
                          [attributionLink]="''">
              </map-legend>
            </div>
          </collapsible-map-control>
        </div>


        <div *ngIf="showSelection" class="map-control right-bottom">
          <collapsible-map-control [heading]="'Site data'">
            <ng-container [ngSwitch]="detailsMode">
              <feature-table *ngSwitchCase="'feature'"
                             [feature]="selectedFeature">

              </feature-table>
              <div *ngSwitchCase="'chart'">
                <timeseries-chart [title]="chartTitle"
                                  [timeSeries]="timeSeries"></timeseries-chart>
                <div>
                  <div class="btn-group btn-group-sm mr-3">
                    <button type="button" class="btn btn-secondary"
                            (click)="timeSeries[timeSeries.length-1].pinned = !timeSeries[timeSeries.length-1].pinned">
                      <i class="fa fa-thumb-tack"
                         [class.greyed]="!timeSeries[timeSeries.length-1].pinned"></i>
                      {{timeSeries[timeSeries.length-1].label}}
                    </button>
                    <div class="btn-group" ngbDropdown placement="top-right" role="group" aria-label="Button group with nested dropdown">
                      <button class="btn btn-secondary dropdown-toggle-split" ngbDropdownToggle></button>
                      <div class="dropdown-menu" ngbDropdownMenu>
                        <button *ngFor="let ts of timeSeries; let i=index" class="dropdown-item"
                                (click)="ts.pinned = !ts.pinned">
                          <i class="fa fa-thumb-tack"
                             [class.greyed]="!ts.pinned"></i>
                          {{ts.label}}
                          <i class="fa fa-minus float-right"
                             (click)="removeTimeSeries(i)"></i>
                        </button>
                      </div>
                    </div>
                  </div>

                  <!--
                  <div class="btn-group btn-group-sm mr-3">
                    <button type="button" class="btn btn-secondary">
                      <i class="fa fa-flask"></i>
                      Split me
                    </button>
                    <div class="btn-group" ngbDropdown placement="top-right" role="group" aria-label="Button group with nested dropdown">
                      <button class="btn btn-secondary dropdown-toggle-split" ngbDropdownToggle></button>
                      <div class="dropdown-menu" ngbDropdownMenu>
                        <button class="dropdown-item">One</button>
                        <button class="dropdown-item">Two</button>
                        <button class="dropdown-item">Four!</button>
                      </div>
                    </div>
                  </div>
-->
<!--
                  <div class="btn-group btn-group-sm mr-3">
                    <button type="button" class="btn btn-secondary">
                      <i class="fa fa-download"></i>
                      Download
                    </button>
                    <div class="btn-group" ngbDropdown placement="top-right" role="group" aria-label="Button group with nested dropdown">
                      <button class="btn btn-secondary dropdown-toggle-split" ngbDropdownToggle></button>
                      <div class="dropdown-menu" ngbDropdownMenu>
                        <button class="dropdown-item">One</button>
                        <button class="dropdown-item">Two</button>
                        <button class="dropdown-item">Four!</button>
                      </div>
                    </div>
                  </div>
-->
                </div>
              </div>
            </ng-container>
          </collapsible-map-control>
        </div>

        <div class="map-control right-top">
          <a href="mailto:http://mailto:albert.vandijk@anu.edu.au?subject=[Feedback from Landscape Visualiser]"
             class="btn btn-primary">
            <img class="img-fluid"
                 style="max-height: 60px;"
                 src="assets/images/feedback_new.png">
          </a>
        </div>
      </layered-map>
    </div>
  </div>
</div>