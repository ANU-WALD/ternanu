<div class="container-fluid">
  <div class="row header-row no-gutters">
    <div class="col-3 sidebar logos tern-gradient-bar">
      <div class="row">
        <div class="col-4 col-xs-12">
            <div class="text-center">
              <a href="https://www.education.gov.au/national-collaborative-research-infrastructure-strategy-ncris" target="_blank" class="ncris-logo">
                <img class="img-fluid" src="assets/images/NCRIS-PROVIDER-MONO.png">
              </a>
            </div>
          </div>
          <div class="col-4 col-xs-12">
          <div class="text-center">
            <a href="http://www.tern.org.au" target="_blank" class="tern-logo">
              <img class="img-fluid" src="assets/images/logo.png">
            </a>
          </div>
        </div>
        <div class="col-4 col-xs-12">
          <div class="text-center">
            <a href="http://wald.anu.edu.au/" target="_blank" class="anu-logo">
              <img class="img-fluid" src="assets/images/anuwald_round_large_tr.png">
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="col-9 app-title">
      <div class="text-center">
        <h1>Landscape Data Visualiser</h1>
      </div>
    </div>
  </div>
  <div class="row main-row no-gutters">
    <div class="col-3 sidebar">
      <ngb-accordion #accordion
                     [activeIds]="openPanels"
                     (panelChange)="panelToggle($event)">

        <ngb-panel class="catalog" id="catalog">
          <ng-template ngbPanelTitle>
            <div>
              <span>Layer selector</span>
              <i class="fa" 
                  [ngClass]="panels.catalog?'fa-chevron-down':'fa-chevron-up'"></i>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <catalog #catalogView
                     [catalog]="catalog" 
                     (layerSelected)="layerSelected($event)"
                     [showPlaceholders]="false"
                     [leafIcon]="''"
                     [collapsedIcon]="'fa fa-folder'"
                     [expandedIcon]="'fa fa-folder-open'"></catalog>
          </ng-template>
        </ngb-panel>

        <ngb-panel *ngIf="layers&&layers.length" id="layers">
          <ng-template ngbPanelTitle>
            <div>
              <span>Visible data</span>
               <i class="fa" 
                   [ngClass]="panels.layers?'fa-chevron-down':'fa-chevron-up'"></i>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <div>
              <layer-control #layerControl 
                             [layers]="layers"
                             (layersChange)="layersChanged($event)"
                             [map]="map"
                             [showLegends]="false"
                             [allowReorder]="false"></layer-control>
            </div>
          </ng-template>
        </ngb-panel>

      </ngb-accordion>
    </div>
    <div class="col-9 main-map">
      <layered-map #map
                   [layers]="layers"
                   (layersChange)="layersChanged($event)"
                   (featureSelected)="featureSelected($event)"
                   (pointSelected)="pointSelected($event)"
                   [mapTypePosition]="mapTypePosition">
        <button-bar class="map-control left-top">
          <zoom-in [map]="map" [maxZoom]="20"></zoom-in>
          <zoom-out [map]="map" [minZoom]="3"></zoom-out>
          <zoom-full [map]="map" [bounds]="fullExtent"></zoom-full>
          <zoom-layer [map]="map" [layer]="topLayer" [fullBounds]="fullExtent"></zoom-layer>
          <button class="btn btn-secondary btn-sm" 
                  ngbTooltip="About"
                  placement="right"
                  (click)="splash.show()">
            <i class="fa fa-question"></i>
          </button>
<!--
          <location-search></location-search>
          <share-view></share-view>
-->
        </button-bar>

        <div class="map-control left-bottom">
          <collapsible-map-control *ngIf="layers.length"
                                   [heading]="'Legend'">
            <div *ngFor="let l of layers">
              <map-legend *ngIf="l.flattenedSettings?.palette || l.legendURL"
                          [title]="l.title"
                          [imageURL]="l.legendURL"
                          [helpText]="l.description()"
                          [mapUnits]="l.flattenedSettings?.units"
                          [cbPalette]="l.flattenedSettings?.palette?.name||l.flattenedSettings?.palette"
                          [cbCount]="l.flattenedSettings?.palette?.count||l.flattenedSettings?.numcolorbands"
                          [cbReverse]="l.flattenedSettings?.palette?.reverse"
                          [cbRange]="l.flattenedSettings?.colorscalerange"
                          [attribution]="l.layer.dataCreator"
                          [attributionLink]="''">
              </map-legend>
            </div>
          </collapsible-map-control>
        </div>


        <div *ngIf="showSelection" class="map-control right-bottom">
          <collapsible-map-control [heading]="'Site data'">
            <ng-container [ngSwitch]="detailsMode">
              <feature-table *ngSwitchCase="'feature'"
                             [feature]="selectedFeature">

              </feature-table>
              <div *ngSwitchCase="'chart'">
                <timeseries-chart [title]="chartTitle"
                                  [timeSeries]="timeSeries"></timeseries-chart>
                <div>
                  <div class="btn-group btn-group-sm mr-3">
                    <button type="button" class="btn btn-secondary"
                            (click)="timeSeries[timeSeries.length-1].pinned = !timeSeries[timeSeries.length-1].pinned">
                      <i class="fa fa-thumb-tack"
                         [class.greyed]="!timeSeries[timeSeries.length-1].pinned"></i>
                      {{timeSeries[timeSeries.length-1].label}}
                    </button>
                    <div class="btn-group" ngbDropdown placement="top-right" role="group" aria-label="Button group with nested dropdown">
                      <button class="btn btn-secondary dropdown-toggle-split" ngbDropdownToggle></button>
                      <div class="dropdown-menu" ngbDropdownMenu>
                        <button *ngFor="let ts of timeSeries; let i=index" class="dropdown-item"
                                (click)="ts.pinned = !ts.pinned">
                          <i class="fa fa-thumb-tack"
                             [class.greyed]="!ts.pinned"></i>
                          {{ts.label}}
                          <i class="fa fa-minus float-right"
                             (click)="removeTimeSeries(i)"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
          </collapsible-map-control>
        </div>

      </layered-map>
    </div>
  </div>
</div>
<one-time-splash #splash [application]='ternanu'>
  Here is my splash!
</one-time-splash>