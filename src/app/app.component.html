<div class="container-fluid">
  <div class="row header-row no-gutters">
    <div class="col-3 sidebar logos">
      <div class="row">
        <div class="col-4 col-xs-12">
            <div class="text-center">
              <a href="https://www.education.gov.au/national-collaborative-research-infrastructure-strategy-ncris" target="_blank" class="ncris-logo">
                <img class="img-fluid" src="assets/images/NCRIS-PROVIDER-MONO.png">
              </a>
            </div>
          </div>
          <div class="col-4 col-xs-12">
          <div class="text-center">
            <a href="http://www.tern.org.au" target="_blank" class="tern-logo">
              <img class="img-fluid" src="assets/images/logo.png">
            </a>
          </div>
        </div>
        <div class="col-4 col-xs-12">
          <div class="text-center">
            <a href="http://wald.anu.edu.au/" target="_blank" class="anu-logo">
              <img class="img-fluid" src="assets/images/anuwald_round_large_tr.png">
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="col-9 app-title">
      <div class="text-center">
        <h1>Landscape Data Visualiser
        </h1>
      </div>
      <a class="about-link" href="#" (click)="showAbout($event)">About</a>
    </div>
  </div>
  <div class="row main-row no-gutters">
    <div class="col-3 sidebar">
      <ngb-accordion #accordion
                     [activeIds]="openPanels"
                     (panelChange)="panelToggle($event)">

        <ngb-panel class="catalog" id="catalog">
          <ng-template ngbPanelTitle>
            <div>
              <span>Data Catalogue</span>
              <i class="fa" 
                  [ngClass]="panels.catalog?'fa-caret-down':'fa-caret-up'"></i>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <catalog #catalogView
                     [catalog]="catalog" 
                     (layerSelected)="layerSelected($event)"
                     [showPlaceholders]="false"
                     [leafIcon]="''"
                     [collapsedIcon]="'fa fa-folder'"
                     [expandedIcon]="'fa fa-folder-open'"></catalog>
          </ng-template>
        </ngb-panel>

        <ngb-panel *ngIf="layers&&layers.length" id="layers">
          <ng-template ngbPanelTitle>
            <div>
              <span>Visible data</span>
               <i class="fa" 
                   [ngClass]="panels.layers?'fa-caret-down':'fa-caret-up'"></i>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <div>
              <layer-control #layerControl 
                             [layers]="layers"
                             (layersChange)="layersChanged($event)"
                             [map]="map"
                             [showLegends]="false"
                             [allowReorder]="false"></layer-control>
            </div>
          </ng-template>
        </ngb-panel>

      </ngb-accordion>
    </div>
    <div class="col-9 main-map">
      <layered-map #map
                   [layers]="layers"
                   [markers]="markers"
                   (layersChange)="layersChanged($event)"
                   (featureSelected)="featureSelected($event)"
                   (pointSelected)="pointSelected($event)"
                   [mapTypePosition]="mapTypePosition"
                   [showMapType]="showWindows"
                   [streetViewControl]="showWindows">
        <div class="map-control left-top">
          <button-bar>
            <div>
              <button class="btn btn-secondary btn-sm" (click)="toggleWindows()">
                <i class="fa" [ngClass]="showWindows?'fa-eye-slash':'fa-eye'"></i>
              </button>
            </div>
            <zoom-in *ngIf="showWindows" [map]="map" [maxZoom]="20"></zoom-in>
            <zoom-out *ngIf="showWindows"  [map]="map" [minZoom]="3"></zoom-out>
            <zoom-full *ngIf="showWindows" [map]="map" [bounds]="fullExtent"></zoom-full>
            <zoom-layer *ngIf="showWindows" [map]="map" [layer]="topLayer" [fullBounds]="fullExtent"></zoom-layer>
          </button-bar>
        </div>

        <div *ngIf="showWindows" class="map-control left-bottom">
          <collapsible-map-control *ngIf="layers.length"
                                   [heading]="'Legend'">
            <div *ngFor="let l of layers">
              <map-legend *ngIf="l.flattenedSettings?.palette || l.legendURL"
                          [title]="l.title"
                          [imageURL]="l.legendURL"
                          [helpText]="l.description()"
                          [mapUnits]="l.flattenedSettings?.units"
                          [cbPalette]="l.flattenedSettings?.palette?.name||l.flattenedSettings?.palette"
                          [cbCount]="l.flattenedSettings?.palette?.count||l.flattenedSettings?.numcolorbands"
                          [cbReverse]="l.flattenedSettings?.palette?.reverse"
                          [cbRange]="l.flattenedSettings?.colorscalerange"
                          [attribution]="l.layer.dataCreator"
                          [attributionLink]="''">
              </map-legend>
            </div>
          </collapsible-map-control>
        </div>


        <div *ngIf="showWindows&&showSelection" class="map-control right-bottom">
          <collapsible-map-control [heading]="'Site data'">
            <ng-container [ngSwitch]="detailsMode">
              <feature-table *ngSwitchCase="'feature'"
                             [feature]="selectedFeature"
                             [styles]="selectedFeatureLayer?.flattenedSettings?.properties">

              </feature-table>
              <div *ngSwitchCase="'chart'">
                <timeseries-chart [title]="chartTitle"
                                  [timeSeries]="timeSeries"></timeseries-chart>
                <div>
                  <div class="btn-group btn-group-sm mr-3">
                    <button type="button" class="btn btn-light"
                            (click)="timeSeries[timeSeries.length-1].pinned = !timeSeries[timeSeries.length-1].pinned">
                      <i class="fa fa-thumb-tack"
                         [class.greyed]="!timeSeries[timeSeries.length-1].pinned"></i>
                      {{timeSeries[timeSeries.length-1].label}}
                    </button>
                    <div class="btn-group" ngbDropdown placement="top-right" role="group" aria-label="Button group with nested dropdown">
                      <button class="btn btn-light dropdown-toggle-split" ngbDropdownToggle></button>
                      <div class="dropdown-menu" ngbDropdownMenu>
                        <button *ngFor="let ts of timeSeries; let i=index" class="dropdown-item"
                                (click)="ts.pinned = !ts.pinned">
                          <i class="fa fa-thumb-tack"
                             [class.greyed]="!ts.pinned"></i>
                          {{ts.label}}
                          <i class="fa fa-minus float-right"
                             (click)="removeTimeSeries(i)"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
          </collapsible-map-control>
        </div>

      </layered-map>
    </div>
  </div>
</div>
<one-time-splash #splash [application]="'ternanu'" [klass]="'about'" [label]="'Welcome to the'">
  <h2 class="about-heading">TERN-ANU Landscape Data Visualiser</h2>

  <p class="about-info">Discover, map and analyse the extensive
    range of landscape-scale ecosystem
    datasets provided by TERN Australia and
    the Australian National University (ANU).
  </p>

  <p class="about-feedback">
    Support & feedback: <a href="mailto:esupport@tern.org.au">esupport@tern.org.au</a>
  </p>

  <div class="row about-links">
    <div class="col-6">
      <a href="http://www.tern.org.au" target="_blank" class="btn btn-lg btn-primary w-100">More Information</a>
    </div>

    <div class="col-6">
      <button (click)="closeAbout()" class="btn btn-lg btn-primary w-100">Continue</button>
    </div>
  </div>

  <p class="small about-disclaimer">
    <strong>Disclaimer:</strong>&nbsp;The TERN-ANU Landscape Data Visualiser and its contents is provided on an "as is" and "as available" basis. You
    understand and agree that you use the TERN-ANU Landscape Data Visualiser at your own discretion and risk and that you will be
    solely responsible for any damange or loss whatsoever that results from such use including use of any data obtained through the
    TERN-ANU Landscape Data Visualiser.
  </p>

  <div class="about-logos">
    <div class="row">
      <div class="col-8">
        <p>Collaboratively produced by:</p>
      </div>
      <div class="col-4">
        <p>With support from:</p>
      </div>
    </div>
    <div class="row">
      <div class="col-4">
        <div class="text-center">
          <a href="http://www.tern.org.au" target="_blank" class="tern-logo">
            <img class="img-fluid" src="assets/images/logo.png">
          </a>
        </div>
      </div>
      <div class="col-4">
        <div class="text-center">
          <a href="http://wald.anu.edu.au/" target="_blank" class="anu-logo">
            <img class="img-fluid" src="assets/images/anuwald_round_large_tr.png">
          </a>
        </div>
      </div>
      <div class="col-4">
        <div class="text-center">
          <a href="https://www.education.gov.au/national-collaborative-research-infrastructure-strategy-ncris" target="_blank" class="ncris-logo">
            <img class="img-fluid" src="assets/images/NCRIS-PROVIDER-MONO.png">
          </a>
        </div>
      </div>
    </div>
  </div>
</one-time-splash>